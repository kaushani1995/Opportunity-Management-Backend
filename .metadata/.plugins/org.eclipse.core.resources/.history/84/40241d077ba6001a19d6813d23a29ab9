package com.accolite.oppmang.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import com.accolite.oppmang.model.*;
import java.util.List;

import com.accolite.oppmang.service.OppmangServiceImpl;

import net.bytebuddy.asm.Advice.Return;


@RestController
@RequestMapping(path = "/oppmang")
public class OppmangController {
	
	@Autowired
	private OppmangServiceImpl oppmangService;
	
	@GetMapping(value = "/opportunities")
	@CrossOrigin(origins = "http://localhost:4200")
	public List<Opportunity> getOpportunities() {

		return oppmangService.getOpportunities();
	}

	@GetMapping(value = "/locations")
	@CrossOrigin(origins = "http://localhost:4200")
	public List<Location> getLocations() {

		return oppmangService.getLocations();
	}
	
	@GetMapping(value = "/locations/{id}")
	@CrossOrigin(origins = "http://localhost:4200")
	public Location getLocations(@PathVariable int id) {
		this.getLocations().forEach(loc -> {
			if(loc.getIdLocation()==id) {return loc;}
		});
		return null;
	}
	
	@GetMapping(value = "/positions")
	@CrossOrigin(origins = "http://localhost:4200")
	public List<Position> getPositions() {
		
		return oppmangService.getPositions();
	}

	@GetMapping(value = "/roles")
	@CrossOrigin(origins = "http://localhost:4200")
	public List<Role> getRoles() {

		return oppmangService.getRoles();
	}

	@GetMapping(value = "/skillsets")
	@CrossOrigin(origins = "http://localhost:4200")
	public List<Skillset> getSkillsets() {

		return oppmangService.getSkillsets();
	}
	
	@GetMapping(value = "/statuses")
	@CrossOrigin(origins = "http://localhost:4200")
	public  List<Status> getStatues(){
		return oppmangService.getStatuses();
	}
	
	@GetMapping(value = "/teams")
	@CrossOrigin(origins = "http://localhost:4200")
	public List<Team> getTeams() {
		
		return oppmangService.getTeams();
	}

	@PostMapping(value = "/opportunities", consumes = "application/json", produces = "application/json")
	@CrossOrigin(origins = "http://localhost:4200")
	public int addOpportunity(@RequestBody OppAndSkills oppAndSkills) {
		
		return oppmangService.addOpportunity(oppAndSkills);
	}

	@PutMapping(value = "/opportunities/{id}")
	@CrossOrigin(origins = "http://localhost:4200")
	public int updateOpportunity(@RequestBody OppAndSkills oppAndSkills) {
	
		return oppmangService.updateOpportunity(oppAndSkills);
	}

	@DeleteMapping(value = "/opportunities/{id}")
	@CrossOrigin(origins = "http://localhost:4200")
	public int deleteOpportunity(@PathVariable int id) {
		
		return oppmangService.deleteOpportunity(id);
	}

	@GetMapping(value = "/opportunities/{id}")
	@CrossOrigin(origins = "http://localhost:4200")
	public OppAndSkills getOpportunity(@PathVariable int id) {

		return oppmangService.getOpportunity(id);
	}
	
	@GetMapping(value = "/user/{email}")
	@CrossOrigin(origins = "http://localhost:4200")
	public User getUser(@PathVariable String email) {
		
		return oppmangService.getUser(email);
	}
	
	

}
